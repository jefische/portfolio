---
import BaseLayout from "../layouts/BaseLayout.astro";
import HorizontalCard from "../components/HorizontalCard.astro";
import { getCollection } from "astro:content";
import getOrderFromSlug from "src/lib/getOrderFromSlug";
import createSlug from "src/lib/createSlug";

const posts = (await getCollection("blog")).sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());

const last_posts = posts.slice(0, 3);

// Fetch projects and sort by filename order
const projects = (await getCollection("projects")).sort((a, b) => getOrderFromSlug(a.slug) - getOrderFromSlug(b.slug));

// Create a map for easy lookup by title
const projectMap = new Map(projects.map((p) => [p.data.title, p]));

// Helper function to get project URL by title
const getProjectUrl = (title: string) => {
	const project = projectMap.get(title);
	return project ? `/projects/${project.slug}` : "#";
};

// Or get projects by index (sorted by order)
const getProjectByOrder = (order: number) => {
	return projects.find((p) => p.data.order === order);
};
---

<BaseLayout sideBarActiveItemID="home">
	<div class="pb-12 mt-5">
		<!-- <div class="text-xl py-1">Hello ðŸ‘‹</div> -->
		<div class="text-5xl font-bold">Jeremy Fischer</div>
		<div class="text-3xl py-3 font-bold">Full-Stack Developer</div>
		<div class="py-2">
			<text class="text-lg">
				I'm currently a contract front-end developer with a strong foundation and formal training in data
				analysis. Iâ€™m passionate about building clean, user-focused web applications and continuously expanding
				my skill set by exploring new technologies. Feel free to browse my projects below to see what Iâ€™ve been
				working on.
			</text>
		</div>
	</div>

	<div>
		<div class="text-3xl w-full font-bold mb-2">My latest projects {"</>"}</div>
	</div>

	<div class="divider my-0"></div>
	<HorizontalCard
		title="Secret Santa Exchange"
		img="/secret_santa_exchange_logo.svg"
		imgBg="#2d3748"
		desc="AI-powered web application that organizes gift exchanges between groups and generates personalized gift recommendations"
		url={getProjectUrl("Secret Santa Exchange")}
		badgeHome={["Next.js", "Supabase", "OpenAI"]}
	/>
	<div class="divider my-0"></div>
	<HorizontalCard
		title="Tennis Database"
		img="/tennis-database.png"
		desc="A full-stack web application for browsing and filtering a curated collection of full-length professional tennis match videos"
		url={getProjectUrl("Tennis Database")}
		badgeHome={["React.js", "Java Spring Boot", "MySQL"]}
	/>
	<div class="divider my-0"></div>
	<HorizontalCard
		title="Wildlife Center of Virginia"
		img="/header-wcv-badge.webp"
		objectContain={true}
		desc="Civic technology project to digitize hospital animal intake forms."
		url={getProjectUrl("Wildlife Center of Virginia")}
		badgeHome={["JavaScript", "Leaflet.js", "Bootstrap"]}
	/>

	<div class="divider my-0"></div>
	<HorizontalCard
		title="Central Oregon Irrigation District"
		img="/COID.PNG"
		imgBg="#fff"
		objectContain={true}
		desc="Client water rights application rebuild with BlueChannel, Inc."
		url={getProjectUrl("Central Oregon Irrigation District")}
		badgeHome={["HTML", "CSS", "JavaScript"]}
	/>
	<div class="divider my-0"></div>
	<HorizontalCard
		title="How to Watch Tennis Online"
		img="/Sports_Tennis-3200x1800.jpg"
		desc="A blog and guide to watching professional tennis online using a VPN."
		url={getProjectUrl("Total Tennis TV")}
		badgeHome={["React.js"]}
	/>
	<!-- <div class="divider my-0"></div>
	<HorizontalCard
		title="Minimax Algorithm"
		img="/TTT_tree_13_v2.png"
		desc="Better understand the minimax algorithm by visualizing the decision tree a computer player takes in a game of tic-tac-toe."
		url="/projects/item2"
		badgeHome={["Javascript", "p5.js"]}
	/> -->

	<!-- <div>
    <div class="text-3xl w-full font-bold mb-5 mt-10">Latest blog posts</div>
  </div> -->

	<!-- {
    last_posts.map((post) => (
      <>
        <HorizontalCard
          title={post.data.title}
          img={post.data.heroImage}
          desc={post.data.description}
          url={"/blog/" + createSlug(post.data.title, post.slug)}
          target="_self"
          badge={post.data.badge}
        />
        <div class="divider my-0" />
      </>
    ))
  } -->
</BaseLayout>
